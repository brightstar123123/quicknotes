<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cloud Autosave Notepad</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body {
  font-family: system-ui;
  margin: 20px;
  background: #f5f5f5;
}

textarea {
  width: 100%;
  height: 60vh;
  padding: 12px;
  font-size: 16px;
  border-radius: 8px;
}

.info {
  margin-top: 8px;
  color: #555;
}
</style>
</head>

<body>

<h2>Cloud Autosave Notepad</h2>
<textarea id="note" placeholder="Start typing..."></textarea>
<div class="info" id="status"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
import {
  getFirestore,
  doc,
  setDoc,
  onSnapshot
} from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

// Import the functions you need from the SDKs you need
import { initializeApp } from "firebase/app";
import { getAnalytics } from "firebase/analytics";
// TODO: Add SDKs for Firebase products that you want to use
// https://firebase.google.com/docs/web/setup#available-libraries

// Your web app's Firebase configuration
// For Firebase JS SDK v7.20.0 and later, measurementId is optional
const firebaseConfig = {
  apiKey: "AIzaSyCM3dF4lyfDdOgGzEdpbiVygQjiEM7YbyE",
  authDomain: "quicknotes-77a6d.firebaseapp.com",
  projectId: "quicknotes-77a6d",
  storageBucket: "quicknotes-77a6d.firebasestorage.app",
  messagingSenderId: "352061113898",
  appId: "1:352061113898:web:9b515f00610124f8662553",
  measurementId: "G-34FYTLCP7D"
};


const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const noteEl = document.getElementById("note");
const status = document.getElementById("status");

const noteRef = doc(db, "notes", "sharedNote");

/* Live sync listener */
onSnapshot(noteRef, snap => {
  if (snap.exists()) {
    noteEl.value = snap.data().text || "";
  }
});

/* Autosave */
noteEl.addEventListener("input", async () => {
  await setDoc(noteRef, {
    text: noteEl.value,
    updated: new Date().toLocaleString()
  });

  status.textContent = "Saved âœ” " + new Date().toLocaleTimeString();
});
</script>

</body>
</html>
